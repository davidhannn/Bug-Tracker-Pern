{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/david/Desktop/Bug-Tracker-Pern/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/david/Desktop/Bug-Tracker-Pern/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"C:/Users/david/Desktop/Bug-Tracker-Pern/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _toConsumableArray from\"C:/Users/david/Desktop/Bug-Tracker-Pern/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import{createSlice}from'@reduxjs/toolkit';import projectService from'../../services/projects';var initialState={projects:[],fetchStatus:'idle',fetchError:null,submitLoading:false,submitError:null,sortBy:'newest'};var projectsSlice=createSlice({name:'projects',initialState:initialState,reducers:{setProjects:function setProjects(state,action){state.projects=action.payload;state.fetchStatus='success';state.fetchError=null;},addProject:function addProject(state,action){state.projects=[].concat(_toConsumableArray(state.projects),[action.payload]);state.submitLoading=false;state.submitError=null;},setProjectsFetchLoading:function setProjectsFetchLoading(state){state.fetchStatus='loading';state.fetchError=null;},removeProject:function removeProject(state,action){state.projects=state.projects.filter(function(project){return project.id!==action.payload;});},updateProjectName:function updateProjectName(state,action){state.projects=state.projects.map(function(project){return project.id===action.payload.projectId?_objectSpread(_objectSpread({},project),action.payload.data):project;});},setSubmitProjectLoading:function setSubmitProjectLoading(state){state.submitLoading=true;state.submitError=null;},sortProjectsBy:function sortProjectsBy(state,action){state.sortBy=action.payload;}}});var _projectsSlice$action=projectsSlice.actions,setProjects=_projectsSlice$action.setProjects,addProject=_projectsSlice$action.addProject,setProjectsFetchLoading=_projectsSlice$action.setProjectsFetchLoading,removeProject=_projectsSlice$action.removeProject,updateProjectName=_projectsSlice$action.updateProjectName,setSubmitProjectLoading=_projectsSlice$action.setSubmitProjectLoading,sortProjectsBy=_projectsSlice$action.sortProjectsBy;export{setProjects,addProject,setProjectsFetchLoading,removeProject,updateProjectName,setSubmitProjectLoading,sortProjectsBy};export var fetchProjects=function fetchProjects(){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var allProjects;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;dispatch(setProjectsFetchLoading());_context.next=4;return projectService.getProjects();case 4:allProjects=_context.sent;dispatch(setProjects(allProjects));_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 11:case\"end\":return _context.stop();}}},_callee,null,[[0,8]]);}));return function(_x){return _ref.apply(this,arguments);};}();};export var createNewProject=function createNewProject(projectData,closeDialog){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var newProject;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;dispatch(setSubmitProjectLoading());_context2.next=4;return projectService.createProject(projectData);case 4:newProject=_context2.sent;dispatch(addProject(newProject));closeDialog&&closeDialog();_context2.next=12;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](0);console.log(_context2.t0);case 12:case\"end\":return _context2.stop();}}},_callee2,null,[[0,9]]);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var deleteProject=function deleteProject(projectId,history){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return projectService.deleteProject(projectId);case 3:history.push('/');dispatch(removeProject(projectId));_context3.next=10;break;case 7:_context3.prev=7;_context3.t0=_context3[\"catch\"](0);console.log(_context3.t0);case 10:case\"end\":return _context3.stop();}}},_callee3,null,[[0,7]]);}));return function(_x3){return _ref3.apply(this,arguments);};}();};export var editProjectName=function editProjectName(projectId,name){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch){var updatedProjectName;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_context4.next=3;return projectService.editProjectName(projectId,name);case 3:updatedProjectName=_context4.sent;dispatch(updateProjectName({data:{name:updatedProjectName.name},projectId:projectId}));_context4.next=10;break;case 7:_context4.prev=7;_context4.t0=_context4[\"catch\"](0);console.log(_context4.t0);case 10:case\"end\":return _context4.stop();}}},_callee4,null,[[0,7]]);}));return function(_x4){return _ref4.apply(this,arguments);};}();};export var selectProjectsState=function selectProjectsState(state){return state.projects;};export var selectProjectById=function selectProjectById(state,projectId){return state.projects.projects.find(function(p){return p.id===projectId;});};export default projectsSlice.reducer;","map":{"version":3,"sources":["C:/Users/david/Desktop/Bug-Tracker-Pern/client/src/redux/slices/projectSlice.ts"],"names":["createSlice","projectService","initialState","projects","fetchStatus","fetchError","submitLoading","submitError","sortBy","projectsSlice","name","reducers","setProjects","state","action","payload","addProject","setProjectsFetchLoading","removeProject","filter","project","id","updateProjectName","map","projectId","data","setSubmitProjectLoading","sortProjectsBy","actions","fetchProjects","dispatch","getProjects","allProjects","console","log","createNewProject","projectData","closeDialog","createProject","newProject","deleteProject","history","push","editProjectName","updatedProjectName","selectProjectsState","selectProjectById","find","p","reducer"],"mappings":"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","sourcesContent":["import { ProjectSortValues } from './../types';\r\nimport { AppThunk } from './../store';\r\nimport { createSlice, PayloadAction } from '@reduxjs/toolkit';\r\nimport { RootState } from '../store';\r\nimport { ProjectState, ProjectPayload } from '../types';\r\nimport projectService from '../../services/projects';\r\nimport { History } from 'history';\r\n\r\ninterface InitialProjectsState {\r\n  projects: ProjectState[];\r\n  fetchStatus: 'idle' | 'loading' | 'success' | 'fail';\r\n  fetchError: string | null;\r\n  submitLoading: boolean;\r\n  submitError: string | null;\r\n  sortBy: ProjectSortValues;\r\n}\r\n\r\nconst initialState: InitialProjectsState = {\r\n  projects: [],\r\n  fetchStatus: 'idle',\r\n  fetchError: null,\r\n  submitLoading: false,\r\n  submitError: null,\r\n  sortBy: 'newest',\r\n};\r\n\r\nconst projectsSlice = createSlice({\r\n  name: 'projects',\r\n  initialState,\r\n  reducers: {\r\n    setProjects: (state, action: PayloadAction<ProjectState[]>) => {\r\n      state.projects = action.payload;\r\n      state.fetchStatus = 'success';\r\n      state.fetchError = null;\r\n    },\r\n    addProject: (state, action: PayloadAction<ProjectState>) => {\r\n      state.projects = [...state.projects, action.payload];\r\n      state.submitLoading = false;\r\n      state.submitError = null;\r\n    },\r\n    setProjectsFetchLoading: (state) => {\r\n      state.fetchStatus = 'loading';\r\n      state.fetchError = null;\r\n    },\r\n    removeProject: (state, action: PayloadAction<string>) => {\r\n      state.projects = state.projects.filter(\r\n        (project) => project.id !== action.payload\r\n      );\r\n    },\r\n    updateProjectName: (\r\n      state,\r\n      action: PayloadAction<{ data: { name: string }; projectId: string }>\r\n    ) => {\r\n      state.projects = state.projects.map((project) =>\r\n        project.id === action.payload.projectId\r\n          ? { ...project, ...action.payload.data }\r\n          : project\r\n      );\r\n    },\r\n    setSubmitProjectLoading: (state) => {\r\n      state.submitLoading = true;\r\n      state.submitError = null;\r\n    },\r\n    sortProjectsBy: (state, action: PayloadAction<ProjectSortValues>) => {\r\n      state.sortBy = action.payload;\r\n    },\r\n  },\r\n});\r\n\r\nexport const {\r\n  setProjects,\r\n  addProject,\r\n  setProjectsFetchLoading,\r\n  removeProject,\r\n  updateProjectName,\r\n  setSubmitProjectLoading,\r\n  sortProjectsBy,\r\n} = projectsSlice.actions;\r\n\r\nexport const fetchProjects = (): AppThunk => {\r\n  return async (dispatch) => {\r\n    try {\r\n      dispatch(setProjectsFetchLoading());\r\n      const allProjects = await projectService.getProjects();\r\n      dispatch(setProjects(allProjects));\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n  };\r\n};\r\n\r\nexport const createNewProject = (\r\n  projectData: ProjectPayload,\r\n  closeDialog?: () => void\r\n): AppThunk => {\r\n  return async (dispatch) => {\r\n    try {\r\n      dispatch(setSubmitProjectLoading());\r\n      const newProject = await projectService.createProject(projectData);\r\n      dispatch(addProject(newProject));\r\n      closeDialog && closeDialog();\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n  };\r\n};\r\n\r\nexport const deleteProject = (\r\n  projectId: string,\r\n  history: History\r\n): AppThunk => {\r\n  return async (dispatch) => {\r\n    try {\r\n      await projectService.deleteProject(projectId);\r\n      history.push('/');\r\n      dispatch(removeProject(projectId));\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n  };\r\n};\r\n\r\nexport const editProjectName = (projectId: string, name: string): AppThunk => {\r\n  return async (dispatch) => {\r\n    try {\r\n      const updatedProjectName = await projectService.editProjectName(\r\n        projectId,\r\n        name\r\n      );\r\n      dispatch(\r\n        updateProjectName({\r\n          data: { name: updatedProjectName.name },\r\n          projectId,\r\n        })\r\n      );\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n  };\r\n};\r\n\r\nexport const selectProjectsState = (state: RootState) => state.projects;\r\n\r\nexport const selectProjectById = (state: RootState, projectId: string) => {\r\n  return state.projects.projects.find((p) => p.id === projectId);\r\n};\r\n\r\nexport default projectsSlice.reducer;\r\n"]},"metadata":{},"sourceType":"module"}